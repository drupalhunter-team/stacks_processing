stacks_processing
=================

The programs contained here are designed to help process the output from Stacks for population genomics work.

Stacks must have already been run for these programs to work. 

Descriptions of the programs:

1. compare_lists
A C++ program that compares two lists of strings (each in a separate .txt file). This program was developed to compare which reference genome contigs had significantly different SNPs (as determined after running Stacks & Stacks' populations program) in different population comparisons. This requires two *.txt files with lists of strings (each string on a separate line), and produces one .txt file with a list of all of the strings that matched.

2. coverage_from_stacks
A C++ program that calculates per-locus and per-individual per-locus summary statistics, including average, minimum, and maximum coverage. This requires *.matches.tsv files for each individual, as output by stacks, and produces three text files with summary statistics (one overall summary, one per-individual summary, and one per-locus summary file).

3. stacks_genomeCIs
A C++ program that calculates 95% and 99% confidence intervals for all of the SNPs throughout the genome from RAD-tag data. These confidence intervals can then be used to evaluate significance of SNPs reliably and conservatively. This requires a batch_x.fst_Y-Z.tsv file (output from Stacks' populations program). It produces two files: one called fst_Y-Z.txt and one called fst_Y-Z_summary.txt, which contain the plottable Fst values and the 99% and 95% genome wide confidence intervals, respectively.


4. stacks_fst_plots.R
An R script (which must be altered within the file to run on your files in your directories) that will plot the SNPs on each contig/chromosome and the genome-wide confidence intervals generated by stacks_genomeCIs. This program gives you the option of plotting every contig/chromosome or only those that have significant SNPs. This script requires the path to the directory where you want your graphs stored and the fst_pop1-pop2.txt and fst_pop1-pop2_summary.txt files output by stacks_genomeCIs. It prints out a graph for every contig (or every contig with significant SNPs, depending on the settings) and a list of all of the contigs/scaffolds/chromosomes containing significant SNPs ("sig.scaffolds.txt").
